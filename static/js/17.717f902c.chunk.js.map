{"version":3,"sources":["utils/ipfs.js","utils/images.js","utils/dates.js","components/projects/hooks.js","images/default-project-img.png","images/new-project.png","components/projects/Projects.jsx"],"names":["ipfsMatcher","Matcher","begin","find","ipfs","IPFS","ipfsHttp","ipfsClient","host","port","protocol","ipfsHttpTheGraph","api-path","window","jsIPFS","on","console","log","bootstrap","add","isIpfs","str","test","captureFile","event","cb","imgCb","stopPropagation","preventDefault","files","target","formattedFiles","formatFileList","saveToIpfs","formattedList","i","length","push","formatForIpfs","file","name","content","type","path","concat","formatForIpfsGateway","ipfsId","progress","prog","then","response","hash","getImageFromIpfs","catch","err","error","uploadFilesToIpfs","_ref","Object","_Users_Barry_projects_status_im_liquid_funding_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__","_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","a","mark","_callee","manifest","gateway","fileLists","formatFn","uploadFn","res","_args","arguments","wrap","_context","prev","next","undefined","uploadToIpfsGateway","uploadToIpfs","keys","forEach","k","_Users_Barry_projects_status_im_liquid_funding_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","Buffer","from","sent","abrupt","stop","_x","_x2","apply","this","_ref2","_callee2","_context2","slice","_x3","_ref3","_callee3","_context3","_x4","pinToGateway","_ref5","_callee5","cid","_context5","split","pin","recursive","_x6","_ref6","_callee6","_context6","getFromIpfs","_x7","_x8","_ref7","_callee7","arrayBufferView","blob","img","_context7","getFiles","Uint8Array","Blob","getImageType","URL","createObjectURL","_Users_Barry_projects_status_im_liquid_funding_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","_x9","CID","clean","Promise","resolve","reject","get","getFilesWeb","getFilesWebTheGraph","isWeb","includes","formatMedia","__webpack_require__","d","__webpack_exports__","isVideo","typeMap","gif","jpg","png","pdf","suffix","toLowerCase","timeSinceBlock","date","interval","date1","Date","date2","timediff","isNaN","NaN","getFullYear","getMonth","Math","floor","day","hour","minute","second","getDateCreated","daysSince","setDate","getDate","getDateFromTimestamp","ts","pretty","toLocaleString","month","callOrderFns","data","setState","regenerator_default","profile","creationTime","addr","tryIpfsGets","_callee4","index","_args4","_context4","ipfsFn","asyncToGenerator","_x17","debug","url","_args5","getPledge","dPledge","pledge","fetch","pledgeData","account","profiles","getDelegateProfiles","_callee8","dPledges","resolved","unnested","expanded","_context8","delegatePledges","getDelegatePledgesByProfile","all","unnest","map","useProfileData","_useState","useState","_useState2","slicedToArray","setDelegatePledges","useEffect","fetchAndAddDelegatePledges","isManifest","asset","getProjectManifest","assets","projectInfo","_data$profile$project","isPlaying","objectSpread","media","JSON","parse","e","_callee9","currencies","goalToken","allowance","_context9","getAllowanceFromAddress","useProjectData","projectId","_useState3","_useState4","projectAge","setAge","_useState5","_useState6","creator","setCreator","_useState7","_useState8","projectAssets","setAssets","_useState9","_useState10","ipfsReady","setIpfsState","_useState11","_useState12","delegateProfiles","setDelegateProfiles","_useState13","_useState14","authorization","setAuthorization","_useContext","useContext","FundingContext","openSnackBar","syncWithRemote","fetchAndAddDelegateProfiles","getProjectAge","getProjectCreator","getProjectAssets","getAuthorization","useMemo","module","exports","p","SORT_TYPES","sortByTitle","b","title","localeCompare","sortByDate","parseInt","Favorite","classes","setFavorites","favorites","className","react__WEBPACK_IMPORTED_MODULE_3___default","createElement","classnames","favorite","isFavorite","onClick","_Users_Barry_projects_status_im_liquid_funding_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","_Users_Barry_projects_status_im_liquid_funding_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","ProjectCard","withDatabase","withObservables","database","project","pledges","collections","query","Q","where","observe","amountsPledged","getAmountsPledged","totalPledged","pledgeCurrency","percentToGoal","min","Number","goal","_material_ui_core_Card__WEBPACK_IMPORTED_MODULE_14__","card","react_router_dom__WEBPACK_IMPORTED_MODULE_4__","to","link","_material_ui_core_CardActionArea__WEBPACK_IMPORTED_MODULE_19__","indexOf","_material_ui_core_CardMedia__WEBPACK_IMPORTED_MODULE_17__","image","defaultProjectImage","_material_ui_core_LinearProgress__WEBPACK_IMPORTED_MODULE_20__","variant","value","_material_ui_core_CardContent__WEBPACK_IMPORTED_MODULE_16__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_13__","align","round","gutterBottom","component","noWrap","description","color","avatar","avatarGrid","alt","src","width","height","cardFavorite","_material_ui_core_CardActions__WEBPACK_IMPORTED_MODULE_15__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_18__","size","CustomTableCell","withStyles","theme","head","palette","text","grey","fontSize","border","body","TableCell","StyledProject","root","margin","typography","body1","filters","float","search","formatBtn","cursor","&:hover, &.active","textAlign","fontWeight","position","top","left","card-title","card-content","card-actions","new-project-img","paddingTop","paddingBottom","nameCell","darkRow","backgroundColor","common","addProjectRow","borderTop","& td","display","backgroundImage","backgroundRepeat","backgroundPosition","&:hover, &.isFavorite","right","zIndex","textDecoration","projectAddedEvents","history","_Users_Barry_projects_status_im_liquid_funding_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","sortType","isGridView","setIsGridView","projects","assign","returnValues","idProject","sortFunction","sort","_base_Loading__WEBPACK_IMPORTED_MODULE_10__","react__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_FormControl__WEBPACK_IMPORTED_MODULE_12__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_21__","placeholder","InputProps","startAdornment","_material_ui_core_InputAdornment__WEBPACK_IMPORTED_MODULE_22__","_material_ui_icons_Search__WEBPACK_IMPORTED_MODULE_23___default","_material_ui_icons_Dashboard__WEBPACK_IMPORTED_MODULE_25___default","active","_material_ui_icons_Reorder__WEBPACK_IMPORTED_MODULE_24___default","rowCounter","_material_ui_core_Table__WEBPACK_IMPORTED_MODULE_26__","table","_material_ui_core_TableHead__WEBPACK_IMPORTED_MODULE_29__","_material_ui_core_TableRow__WEBPACK_IMPORTED_MODULE_30__","_material_ui_core_TableBody__WEBPACK_IMPORTED_MODULE_27__","row","key","hover","newProjectImage","ListView","_ref4","_material_ui_core_Grid__WEBPACK_IMPORTED_MODULE_11__","container","spacing","item","xs","sm","md","lg","style","GridView"],"mappings":"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","file":"static/js/17.717f902c.chunk.js","sourcesContent":["import IPFS from 'ipfs'\nimport ipfsClient from 'ipfs-http-client'\nimport { Buffer } from 'buffer'\nimport { Matcher } from '@areknawo/rex'\nimport { getImageType } from './images'\n\nconst ipfsMatcher = new Matcher().begin().find('ipfs/')\nexport const ipfs = new IPFS()\nconst ipfsHttp = ipfsClient({ host: 'test-ipfs.status.im', port: '2053', protocol: 'https' })\nconst ipfsHttpTheGraph = ipfsClient({ host: 'api.thegraph.com', 'api-path': '/ipfs/api/v0/', protocol: 'https', port: '443' })\n\nwindow.ipfsHttp = ipfsHttp\nwindow.ipfsHttpTheGraph = ipfsHttpTheGraph\nwindow.jsIPFS = ipfs\n\nipfs.on('ready', () => {\n  console.log('Node is ready to use!')\n  // Add status ipfs node as peer\n  ipfs.bootstrap.add('/ip4/35.188.209.83/tcp/4001/ipfs/QmZqW6QHdDVyHMvYktpA1PAuKgvqhwumbuFqFB5URedSbA')\n})\n\n\nexport const isIpfs = str => ipfsMatcher.test(str)\nexport const captureFile = (event, cb, imgCb) => {\n  event.stopPropagation()\n  event.preventDefault()\n  const files = event.target.files\n  const formattedFiles = formatFileList(files)\n  console.log({files, formattedFiles})\n  saveToIpfs(formattedFiles, cb, imgCb)\n}\n\nexport const formatFileList = files => {\n  const formattedList = []\n  for (let i=0; i<files.length; i++) {\n    formattedList.push(formatForIpfs(files[i]))\n  }\n  return formattedList\n}\n\nexport const formatForIpfs = file => {\n  const { name, type: _type } = file\n  const content = file\n  return {\n    path:  `/root/${name}`,\n    content\n  }\n}\n\nexport const formatForIpfsGateway = file => {\n  const { name, type: _type } = file\n  const content = file\n  return {\n    path:  `/root/${name}`,\n    content\n  }\n}\n\nexport const saveToIpfs = (files, cb, imgCb) => {\n  let ipfsId\n  ipfs.add(files, { progress: (prog) => console.log(`received: ${prog}`) })\n    .then((response) => {\n      console.log(response)\n      ipfsId = response[0].hash\n      cb(`ipfs/${ipfsId}`)\n      getImageFromIpfs(ipfsId, imgCb)\n    }).catch((err) => {\n      console.error(err)\n    })\n}\n\nexport const uploadFilesToIpfs = async (files, manifest, gateway = false) => {\n  let fileLists = []\n  const formatFn = gateway ? formatForIpfsGateway : formatForIpfs\n  const uploadFn = gateway ? uploadToIpfsGateway : uploadToIpfs\n  Object.keys(files).forEach(k => {\n    fileLists = [...fileLists, formatFn(files[k][0])]\n  })\n  fileLists.push({\n    path: '/root/manifest.json', content: Buffer.from(manifest)\n  })\n  const res = await uploadFn(fileLists)\n  return res\n}\n\nexport const uploadToIpfs = async files => {\n  const res = await ipfs.add(\n    files,\n    {\n      progress: (prog) => console.log(`received: ${prog}`)\n    }\n  )\n  return `ipfs/${res.slice(-1)[0].hash}`\n}\n\nexport const uploadToIpfsGateway = async files => {\n  const res = await ipfsHttpTheGraph.add(files)\n  return `ipfs/${res.slice(-1)[0].hash}`\n}\n\nexport const pinToIpfs = async hash => {\n  const cid = hash.split('/').slice(-1)[0]\n  const res = await ipfs.pin.add(cid, { recursive: false })\n  console.log({res})\n}\n\nexport const pinToGateway = async hash => {\n  const cid = hash.split('/').slice(-1)[0]\n  const res = await ipfsHttp.pin.add(cid, { recursive: true })\n  console.log({res})\n}\n\nexport const getImageFromIpfs = async (hash, cb) => {\n  const res = await getFromIpfs(hash)\n  cb(res)\n}\n\nexport const getFromIpfs = async hash => {\n  const files = await getFiles(hash)\n  const file = files.slice(-1)[0]\n  const { content } = file\n  const arrayBufferView = new Uint8Array(content)\n  const blob = new Blob([arrayBufferView], { type: getImageType(file) })\n  const img = URL.createObjectURL(blob)\n  return { ...file, img }\n}\n\nexport const getFiles = CID => {\n  const clean = CID.split('/').slice(-1)[0]\n  return new Promise(function(resolve, reject) {\n    ipfs.get(clean, (err, files) => {\n      if (err) reject(err)\n      else resolve(files)\n    })\n  })\n}\n\nexport const getFilesWeb = CID => {\n  const clean = CID.split('/').slice(-1)[0]\n  return new Promise(function(resolve, reject) {\n    ipfsHttp.get(clean, (err, files) => {\n      if (err) reject(err)\n      else resolve(files)\n    })\n  })\n}\n\nexport const getFilesWebTheGraph = CID => {\n  const clean = CID.split('/').slice(-1)[0]\n  return new Promise(function(resolve, reject) {\n    ipfsHttpTheGraph.get(clean, (err, files) => {\n      if (err) reject(err)\n      else resolve(files)\n    })\n  })\n}\n\nexport const isWeb = str => str.includes('http')\nexport const formatMedia = str => {\n  return isWeb(str) ? str : `/root/${str}`\n}\n","const typeMap = {\n  'gif': 'image/gif',\n  'jpg': 'image/jpeg',\n  'png': 'image/png',\n  'pdf': 'application/pdf'\n}\n\nexport const getImageType = file => {\n  const suffix = file.split('.').slice(-1)[0].toLowerCase()\n  return typeMap[suffix] ? typeMap[suffix] : 'image/jpeg'\n}\n\nexport const isVideo = file => file.type.includes('video')\n","export function timeSinceBlock(date=false, interval) {\n  var second=1000, minute=second*60, hour=minute*60, day=hour*24, week=day*7;\n  let date1 = date ? new Date(date*1000) : new Date();\n  let date2 = new Date();\n  var timediff = date2 - date1;\n  if (isNaN(timediff)) return NaN;\n  switch (interval) {\n  case 'years': return date2.getFullYear() - date1.getFullYear();\n  case 'months': return (\n    ((date2.getFullYear() * 12) + date2.getMonth())      -\n      ((date1.getFullYear() * 12) + date1.getMonth())\n  );\n  case 'weeks': return Math.floor(timediff / week)\n  case 'days': return Math.floor(timediff / day)\n  case 'hours': return Math.floor(timediff / hour)\n  case 'minutes': return Math.floor(timediff / minute)\n  case 'seconds': return Math.floor(timediff / second)\n  default: return undefined\n  }\n}\n\nexport function getDateCreated(daysSince) {\n  const d = new Date();\n  d.setDate(d.getDate() - daysSince);\n  return `${d.getMonth()+1}/${d.getDate()}/${d.getFullYear()}`\n}\n\nexport function getDateFromTimestamp(ts, pretty = false) {\n  const d = new Date(ts*1000);\n  if (pretty) return `${d.getDate()} ${d.toLocaleString('default', { month: 'short'})} ${d.getFullYear()}`\n  return `${d.getMonth()+1}/${d.getDate()}/${d.getFullYear()}`\n}\n\nexport const convertToHours = seconds => Number(seconds) / 60 / 60\n","import { useState, useEffect, useMemo, useContext } from 'react'\nimport { unnest } from 'ramda'\nimport { timeSinceBlock } from '../../utils/dates'\nimport { getFiles, getFilesWeb, ipfs, getFilesWebTheGraph } from '../../utils/ipfs'\nimport { getAllowanceFromAddress } from '../../utils/currencies'\nimport { arrayToObject } from '../../utils/array'\nimport { FundingContext } from '../../context'\nimport { getDelegateProfiles } from '../../actions/profiles'\nimport { getDelegatePledgesByProfile } from '../../actions/delegates'\n\nconst callOrderFns = [getFiles, getFilesWeb, getFilesWebTheGraph]\nasync function getProjectAge(data, setState){\n  if (data && data.profile) {\n    setState(timeSinceBlock(data.profile.creationTime, 'days'))\n  } else {\n    setState(timeSinceBlock(false, 'days'))\n  }\n}\n\nasync function getProjectCreator(data, setState){\n  if (!data || !data.profile) return\n  const { addr } = data.profile\n  setState(addr)\n}\n\nasync function tryIpfsGets(CID, setState, index=0){\n  const ipfsFn = callOrderFns[index]\n  ipfsFn(CID)\n    .then((files) => {\n      console.log('IPFS get sucessful on attempt: ', index+1)\n      setState(files)\n    })\n    .catch(async (err) => {\n      console.log('IPFS getFilesWeb error: ', err, 'Attempt: ', index + 1)\n      if (callOrderFns[index + 1]) tryIpfsGets(CID, setState, index + 1)\n    })\n}\n\nasync function getProjectAssets(data, setState, debug=false){\n  if (!data || !data.profile) return\n  const { profile: { url } } = data\n  const CID = url.split('/').slice(-1)[0]\n  if (debug) console.log({CID, data, ipfs})\n  tryIpfsGets(CID, setState)\n}\n\nasync function getPledge(dPledge) {\n  const pledge = await dPledge.pledge.fetch()\n  dPledge.pledgeData = pledge\n  return dPledge\n}\n\nasync function fetchAndAddDelegateProfiles(account, setState) {\n  const profiles = await getDelegateProfiles(account)\n  setState(profiles)\n}\n\nasync function fetchAndAddDelegatePledges(profiles, setState) {\n  const dPledges = []\n  if (!profiles || !profiles.length) {\n    return setState(dPledges)\n  }\n  profiles.forEach(profile => {\n    const delegatePledges = getDelegatePledgesByProfile(profile)\n    dPledges.push(delegatePledges)\n  })\n  const resolved = await Promise.all(dPledges)\n  const unnested = unnest(resolved)\n  const expanded = await Promise.all(unnested.map(getPledge))\n  setState(expanded)\n}\n\nexport function useProfileData(profiles) {\n  const [delegatePledges, setDelegatePledges] = useState(null)\n\n  useEffect(() => {\n    fetchAndAddDelegatePledges(profiles, setDelegatePledges)\n  }, [profiles])\n  return delegatePledges\n}\n\nconst isManifest = asset => {\n  const name = asset.path.split('/').slice(-1)[0]\n  return name.toLowerCase() === 'manifest.json'\n}\nconst getProjectManifest = (data, assets) => {\n  if (data && data.profile && data.profile.projectInfo) {\n    const { isPlaying, type, file } = data.profile.projectInfo\n    return {\n      ...data.profile.projectInfo,\n      media: {\n        isPlaying,\n        type,\n        file\n      }\n    }\n  }\n\n  if (!assets) {\n    return null;\n  }\n\n  const manifest = assets.find(isManifest);\n  if (!manifest) {\n    return null;\n  }\n  try {\n    return JSON.parse(manifest.content)\n  } catch (e) {\n    return null;\n  }\n}\n\nasync function getAuthorization(data, setState, currencies) {\n  if (!data || !data.profile) return\n  const { profile: { projectInfo: { goalToken } } } = data\n  const allowance = await getAllowanceFromAddress(goalToken, currencies)\n  setState(allowance)\n}\n\nexport function useProjectData(projectId, data) {\n  const [projectAge, setAge] = useState(null)\n  const [creator, setCreator] = useState(null)\n  const [projectAssets, setAssets] = useState(null)\n  const [ipfsReady, setIpfsState] = useState(null)\n  const [delegateProfiles, setDelegateProfiles] = useState(null)\n  const [authorization, setAuthorization] = useState(0)\n  const { account, currencies, openSnackBar, syncWithRemote } = useContext(FundingContext)\n\n  useEffect(() => {\n    ipfs.on('ready', () => { setIpfsState(true) })\n  }, [projectId])\n\n  useEffect(() => {\n    fetchAndAddDelegateProfiles(account, setDelegateProfiles)\n  }, [account])\n\n  useEffect(() => {\n    getProjectAge(data, setAge)\n  }, [data, projectId])\n\n  useEffect(() => {\n    getProjectCreator(data, setCreator)\n  }, [data, projectId])\n\n  useEffect(() => {\n    getProjectAssets(data, setAssets)\n  }, [ipfsReady, data])\n\n  useEffect(() => {\n    if (account && currencies) getAuthorization(data, setAuthorization, currencies)\n  }, [account, data, currencies])\n\n  const manifest = useMemo(() => getProjectManifest(data, projectAssets), [data, projectAssets, projectId])\n\n  return {\n    account,\n    authorization,\n    creator,\n    projectAge,\n    projectAssets,\n    manifest,\n    delegateProfiles,\n    openSnackBar,\n    syncWithRemote\n  }\n}\n\nfunction mergePledgesAuthorizations(pledges, authorizations, setState) {\n  const auths = arrayToObject(authorizations, 'ref')\n  const enriched = pledges.map(pledge => {\n    const { idPledge } = pledge\n    if (auths[idPledge]) pledge.authorization = auths[idPledge]\n    return pledge\n  })\n  setState(enriched)\n}\nexport function usePledgesAuthorizations(pledges, authorizations, confirmedPayments) {\n  const [enrichedPledges, setEnrichedPledges] = useState(pledges)\n  const confirmedIds = confirmedPayments.map(p => p.returnValues.idPayment)\n  const filteredAuths = authorizations.filter(\n    a => !confirmedIds.includes(a.returnValues.idPayment)\n  )\n\n  useEffect(() => {\n    mergePledgesAuthorizations(pledges, filteredAuths, setEnrichedPledges)\n  }, [pledges, authorizations])\n\n  return enrichedPledges\n}\n","module.exports = __webpack_public_path__ + \"static/media/default-project-img.dfa31e68.png\";","module.exports = \"data:image/png;base64,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\"","import React, {Fragment, useState, useMemo} from 'react'\nimport { Link } from 'react-router-dom'\nimport {withStyles} from '@material-ui/core/styles'\nimport {withDatabase} from \"@nozbe/watermelondb/DatabaseProvider\";\nimport withObservables from \"@nozbe/with-observables\";\nimport {Q} from \"@nozbe/watermelondb\";\nimport PropTypes from 'prop-types'\nimport {useProjectData} from \"./hooks\";\nimport Loading from \"../base/Loading\";\nimport Grid from '@material-ui/core/Grid';\nimport FormControl from '@material-ui/core/FormControl';\nimport Typography from \"@material-ui/core/Typography\";\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Button from '@material-ui/core/Button';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport TextField from '@material-ui/core/TextField';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport SearchIcon from '@material-ui/icons/Search';\nimport ListIcon from '@material-ui/icons/Reorder';\nimport DashboardIcon from '@material-ui/icons/Dashboard';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport classnames from 'classnames';\n\nimport { getAmountsPledged } from '../../utils/pledges'\nimport defaultProjectImage from '../../images/default-project-img.png';\nimport newProjectImage from '../../images/new-project.png';\n\nconst SORT_TYPES = {\n  date: 'date',\n  name: 'name'\n}\n\nconst cardAbsolutesDistance = 26;\n\nconst styles = theme => {\n  return ({\n    root: {\n      margin: '1.75rem 4.5rem',\n      ...theme.typography.body1\n    },\n    filters: {\n      float: 'right'\n    },\n    search: {\n      height: 36\n    },\n    formatBtn: {\n      cursor: 'pointer',\n      '&:hover, &.active': {\n        color: 'black'\n      }\n    },\n    title: {\n      fontSize: '20px',\n      textAlign: 'center',\n      fontWeight: 500\n    },\n    media: {\n      height: 235,\n      position: 'relative'\n    },\n    avatarGrid: {\n      position: 'absolute',\n      top: cardAbsolutesDistance,\n      left: cardAbsolutesDistance\n    },\n    'card-title': {\n      fontSize: '20px'\n    },\n    'card-content': {\n      fontSize: '16px'\n    },\n    'card-actions': {\n      float: 'right'\n    },\n    progress: {\n      height: 10\n    },\n    'new-project-img': {\n      textAlign: 'center',\n      margin: 0,\n      paddingTop: 115,\n      paddingBottom: 43\n    },\n    nameCell: {\n      fontSize: 18\n    },\n    darkRow: {\n      backgroundColor: theme.palette.common.grey\n    },\n    addProjectRow: {\n      borderTop: '0.25px solid ' + theme.palette.text.grey,\n      cursor: 'pointer',\n      '& td': {\n        paddingTop: 35\n      }\n    },\n    favorite: {\n      display: 'inline-block',\n      backgroundImage: 'url(\"/images/favorite-sprite.png\")',\n      backgroundRepeat: 'no-repeat',\n      backgroundPosition: 'bottom',\n      width: 30,\n      height: 27,\n      cursor: 'pointer',\n      '&:hover, &.isFavorite': {\n        backgroundPosition: 'top'\n      }\n    },\n    cardFavorite: {\n      position: 'absolute',\n      top: cardAbsolutesDistance,\n      right: cardAbsolutesDistance,\n      zIndex: 9000\n    },\n    link: {\n      textDecoration: 'none'\n    }\n  })\n}\n\nfunction sortByTitle(a, b) {\n  if (!a.manifest || !b.manifest) {\n    return 0;\n  }\n  return a.manifest.title.localeCompare(b.manifest.title)\n}\n\n// No date field, but we can use the ID\nfunction sortByDate(a, b) {\n  if (parseInt(a.projectId, 10) > parseInt(b.projectId, 10)) {\n    return -1;\n  }\n  return 1;\n}\n\nfunction Favorite({classes, setFavorites, favorites, projectId, className}) {\n  return (\n    <span\n      className={classnames(className, classes.favorite, {isFavorite: favorites[projectId]})}\n      onClick={() => setFavorites({...favorites, [projectId]: !favorites[projectId]})} />\n  );\n}\n\nfunction RawProjectCard({classes, project, pledges, favorites, setFavorites}) {\n  const { manifest } = project\n  const amountsPledged = useMemo(() => getAmountsPledged(pledges), [pledges])\n  const totalPledged = amountsPledged[0] ? amountsPledged[0][1] : 0\n  const pledgeCurrency = amountsPledged[0] ? amountsPledged[0][0] : 'ETH'\n  const percentToGoal = manifest ? Math.min(\n    (Number(totalPledged) / Number(manifest.goal)) * 100,\n    100\n  ) : 0\n  return (\n    <Card className={classes.card}>\n      <Link to={`/project/${project.projectId}`} className={classes.link}>\n        <CardActionArea onClick={e => { if (e.target.className.indexOf(classes.favorite) > -1) { e.preventDefault() } }}>\n          <CardMedia\n            className={classes.media}\n            image={defaultProjectImage}\n            title=\"Project image\"\n          />\n          <LinearProgress className={classes.progress} variant=\"determinate\" value={percentToGoal} />\n          <CardContent>\n            <Typography align=\"right\" className={classes['card-content']}>{Math.round(totalPledged)} pledged of {manifest.goal} {pledgeCurrency}</Typography>\n            <Typography align=\"right\" className={classes['card-content']}>3 funders</Typography> {/*TODO get actual funders*/}\n            <Typography gutterBottom variant=\"h5\" component=\"h2\" className={classes['card-title']} noWrap>\n              {project.manifest.title}\n            </Typography>\n            <Typography component=\"p\" className={classes['card-content']} noWrap gutterBottom>\n              {project.manifest.description}&nbsp;\n            </Typography>\n            <Typography component=\"p\" className={classes['card-content']} color=\"textSecondary\">\n              Delegate: {project.manifest.creator} {/*TODO check if that really is the delegate*/}\n            </Typography>\n            {project.manifest.avatar && <img className={classes.avatarGrid} alt=\"avatar\" src={project.manifest.avatar} width={40} height={40}/>}\n            <Favorite className={classes.cardFavorite} classes={classes} favorites={favorites} projectId={project.projectId} setFavorites={setFavorites}/>\n          </CardContent>\n        </CardActionArea>\n        <CardActions className={classes['card-actions']}>\n          <Link to={`/project/${project.projectId}`} className={classes.link}>\n            <Button size=\"small\" color=\"primary\">\n              Read more\n            </Button>\n          </Link>\n        </CardActions>\n      </Link>\n    </Card>)\n}\n\nconst ProjectCard = withDatabase(withObservables(['project'], ({ database, project }) => ({\n  pledges: database.collections.get('pledges').query(\n    Q.where('intended_project', project.projectId)\n  ).observe()\n}))(RawProjectCard))\n\nfunction GridView({classes, projects, favorites, setFavorites}) {\n  return (<Grid container spacing={40}>\n    {projects.map((project, index) => {\n      if (!project.manifest) {\n        return ''\n      }\n      return (<Grid key={'project-' + index} item xs={12} sm={6} md={4} lg={3} className={classes.card}>\n        <ProjectCard project={project} classes={classes} favorites={favorites} setFavorites={setFavorites}/>\n      </Grid>);\n    })}\n    <Grid item xs={12} sm={6} md={4} lg={3} className=\"project-list-item\">\n      <Card className={classes.card}>\n        <Link to=\"/create-project/\" className={classes.link} >\n          <CardActionArea style={{height: 460}}>\n            <p className={classes['new-project-img']}><img alt=\"new project\" src={newProjectImage}/></p>\n            <Typography align=\"center\" className={classes['card-content']}>Add your own project</Typography>\n          </CardActionArea>\n        </Link>\n      </Card>\n    </Grid>\n  </Grid>)\n}\n\nconst CustomTableCell = withStyles(theme => ({\n  head: {\n    color: theme.palette.text.grey,\n    fontSize: 15,\n    border: 0\n  },\n  body: {\n    fontSize: 16,\n    border: 0,\n    height: 80\n  }\n}))(TableCell);\n\nfunction ListView({classes, projects, history, favorites, setFavorites}) {\n  let rowCounter = -1;\n  return (<Table className={classes.table}>\n    <TableHead>\n      <TableRow>\n        <CustomTableCell>&nbsp;</CustomTableCell>\n        <CustomTableCell>Project name</CustomTableCell>\n        <CustomTableCell>Description</CustomTableCell>\n        <CustomTableCell>Funding details</CustomTableCell>\n        <CustomTableCell>Delegate</CustomTableCell>\n        <CustomTableCell>&nbsp;</CustomTableCell>\n        <CustomTableCell>&nbsp;</CustomTableCell>\n      </TableRow>\n    </TableHead>\n    <TableBody>\n      {projects.map((project, index) => {\n        rowCounter++;\n        if (!project.manifest) {\n          return ''\n        }\n        return (\n          <TableRow className={classnames(classes.row, {[classes.darkRow]: rowCounter%2})} key={'project-' + index}>\n            <CustomTableCell>\n              {project.manifest.avatar &&\n               <img className={classes.avatar} alt=\"avatar\" src={project.manifest.avatar} width={40} height={40}/>}\n            </CustomTableCell>\n            <CustomTableCell className={classes.nameCell}>{project.manifest.title}</CustomTableCell>\n            <CustomTableCell>{project.manifest.description}</CustomTableCell>\n            <CustomTableCell>76% of 2.055 ETH<br/>3 funders</CustomTableCell>\n            <CustomTableCell>{project.manifest.creator}</CustomTableCell>\n            <CustomTableCell>\n              <Favorite classes={classes} favorites={favorites} projectId={project.projectId} setFavorites={setFavorites}/>\n            </CustomTableCell>\n            <CustomTableCell>\n              <Link to={`/project/${project.projectId}`} className={classes.link}>\n                <Button size=\"small\" color=\"primary\">Read more</Button>\n              </Link>\n            </CustomTableCell>\n          </TableRow>\n        )\n      })}\n      <TableRow className={classnames(classes.row, classes.addProjectRow)} hover onClick={() => history.push('/create-project/')}>\n        <CustomTableCell>\n          <img alt=\"add project\" src={newProjectImage} width={40} height={40}/>\n        </CustomTableCell>\n        <CustomTableCell>Add your own project</CustomTableCell>\n        <CustomTableCell/>\n        <CustomTableCell/>\n        <CustomTableCell/>\n        <CustomTableCell/>\n        <CustomTableCell/>\n      </TableRow>\n    </TableBody>\n  </Table>)\n}\n\nfunction Projects({projectAddedEvents, classes, history}) {\n  const [favorites, setFavorites] = useState({});\n  const [sortType, _setSortType] = useState(SORT_TYPES.date);\n  const [isGridView, setIsGridView] = useState(true);\n\n  const projects = projectAddedEvents.map(event => {\n    return Object.assign({projectId: event.returnValues.idProject}, useProjectData(event.returnValues.idProject, projectAddedEvents));\n  })\n\n  let sortFunction = (sortType === SORT_TYPES.name) ? sortByTitle : sortByDate;\n  projects.sort(sortFunction);\n\n  return (<div className={classes.root}>\n    <Typography className={classes.title} component=\"h2\" gutterBottom>All projects</Typography>\n\n    {projects.length === 0 && <Loading/>}\n\n    {projects.length > 0 &&\n     <Fragment>\n       <div className={classes.filters}>\n         <FormControl>\n           <TextField\n             variant=\"outlined\"\n             placeholder=\"Filter by tags\"\n             InputProps={{\n               className: classes.search,\n               startAdornment: <InputAdornment position=\"start\"><SearchIcon/></InputAdornment>,\n             }}\n           />\n         </FormControl>\n\n         <DashboardIcon className={classnames(classes.formatBtn, {'active': isGridView})} color=\"disabled\" fontSize=\"large\" onClick={() => setIsGridView(true)}/>\n         <ListIcon className={classnames(classes.formatBtn, {'active': !isGridView})} color=\"disabled\" fontSize=\"large\" onClick={() => setIsGridView(false)}/>\n       </div>\n\n       {!isGridView && ListView({classes, projects, history, favorites, setFavorites})}\n       {isGridView && GridView({classes, projects, favorites, setFavorites})}\n     </Fragment>\n    }\n  </div>)\n}\n\nProjects.propTypes = {\n  projectAddedEvents: PropTypes.array,\n  classes: PropTypes.object\n}\n\nconst StyledProject = withStyles(styles)(Projects)\nexport default withDatabase(withObservables([], ({database}) => ({\n  projectAddedEvents: database.collections.get('lp_events').query(\n    Q.where('event', 'ProjectAdded')\n  ).observe()\n}))(StyledProject))\n"],"sourceRoot":""}